ğŸ›¡ï¸ LLMNR Poisoning Attack & Mitigation (Active Directory Lab)
ğŸ“Œ Overview

As part of my home Active Directory lab, I performed an LLMNR poisoning attack to demonstrate how attackers can capture and crack Windows authentication hashes on a local network.
After successfully exploiting the weakness, I implemented enterprise mitigations to secure the environment.

This simulates a real internal pentest attack path.

ğŸ–¥ï¸ Lab Environment
Infrastructure

1 Ã— Domain Controller (Windows Server)

2 Ã— Domain-joined Windows Clients

VirtualBox NAT Network

Tools Used

Kali Linux

Responder

Hashcat

Windows Group Policy

âš”ï¸ Attack Walkthrough
What is LLMNR?

LLMNR (Link-Local Multicast Name Resolution) is used when DNS fails to resolve a hostname.

When a user tries to access a resource that doesnâ€™t exist, Windows broadcasts:

â€œWho has this hostname?â€

An attacker can respond first and impersonate the requested service, capturing NTLM authentication hashes.

Step 1 â€” Start Responder (Attacker Machine)
sudo responder -I eth0 -rdwv

Responder listens for broadcast name resolution requests and poisons the response.

Step 2 â€” Victim Triggers Name Resolution

A domain user attempts to access a non-existent share:

\\fileshare

DNS fails â†’ Windows falls back to LLMNR â†’ attacker responds.

Step 3 â€” Capture NTLM Hash

Responder captures the NTLMv2 hash:

[SMB] NTLMv2-SSP Hash captured from USER

The attacker now has the victimâ€™s authentication hash.

Step 4 â€” Crack the Hash

Using Hashcat with the rockyou wordlist:

hashcat -m 5600 hash.txt /usr/share/wordlists/rockyou.txt

Attack chain complete:

LLMNR Poisoning â†’ Hash Capture â†’ Hash Cracking â†’ Credential Access
ğŸ’¥ Impact

With valid credentials an attacker can:

Access SMB shares

Move laterally across the network

Escalate privileges

Potentially compromise the domain

This attack is extremely common in internal penetration tests.

ğŸ› ï¸ Mitigation & Hardening
1ï¸âƒ£ Disable LLMNR (Primary Defense)

Configured via Group Policy:

Computer Configuration
 â†’ Administrative Templates
 â†’ Network
 â†’ DNS Client
 â†’ Turn OFF Multicast Name Resolution = Enabled

This stops Windows from broadcasting hostname requests.

2ï¸âƒ£ Disable NetBIOS (NBT-NS)

On each network adapter:

IPv4 â†’ Advanced â†’ WINS â†’ Disable NetBIOS over TCP/IP

Removes the legacy fallback protocol used in the attack.

3ï¸âƒ£ Enforce Strong Password Policy

LLMNR attacks rely on hash cracking.

Best practices:

Minimum 14+ characters

Avoid common words

Use passphrases

Example:

Weak  : Summer2024!
Strong: MyDogEatsPizzaAtMidnight!
ğŸ“ Lessons Learned

This lab demonstrates how:

Legacy protocols create modern security risks

Internal attacks require minimal access

Proper hardening fully prevents this attack

ğŸ§  Skills Demonstrated

Active Directory lab deployment

Internal network attack simulation

Credential capture & cracking

Windows security hardening

Security documentation & reporting
